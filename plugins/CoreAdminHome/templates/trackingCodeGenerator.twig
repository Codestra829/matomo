{% extends 'admin.twig' %}

{% block head %}
    {{ parent() }}
    <link rel="stylesheet" href="plugins/CoreAdminHome/stylesheets/jsTrackingGenerator.css" />
{% endblock %}

{% set title %}{{ 'CoreAdminHome_TrackingCode'|translate }}{% endset %}

{% block content %}

    <div class="card">
        <div class="card-content">
            <h2 piwik-enriched-headline
                help-url="https://matomo.org/docs/tracking-api/"
                rate="{{ 'CoreAdminHome_TrackingCode'|translate|e('html_attr') }}">{{ 'CoreAdminHome_TrackingCode'|translate  }}</h2>
            <p style="padding-left: 0;">{{ 'CoreAdminHome_TrackingCodeIntro'|translate }}</p>
        </div>
        <div class="card-action">
            {{ 'General_GoTo2'|translate }}:
            <a href="#/javaScriptTracking">{{ 'CoreAdminHome_JavaScriptTracking'|translate  }}</a>
            <a href="#/imageTracking">{{ 'CoreAdminHome_ImageTracking'|translate }}</a>
            <a href="#/importServerLogs">{{ 'CoreAdminHome_ImportingServerLogs'|translate }}</a>
            <a href="#/mobileAppsAndSdks">{{ 'SitesManager_MobileAppsAndSDKs'|translate }}</a>
            <a href="#/trackingApi">{{ 'CoreAdminHome_HttpTrackingApi'|translate }}</a>
            {{ postEvent('Template.endTrackingCodePageTableOfContents') }}
        </div>
    </div>

    <input type="hidden" name="numMaxCustomVariables"
           value="{{ maxCustomVariables|e('html_attr') }}">

<div
    matomo-js-tracking-code-generator
    default-site="{{ defaultSite|json_encode|e('html_attr') }}"
    max-custom-variables="{{ maxCustomVariables|json_encode|e('html_attr') }}"
    server-side-do-not-track-enabled="{{ serverSideDoNotTrackEnabled|json_encode|e('html_attr') }}"
></div>

<div piwik-content-block content-title="{{ 'CoreAdminHome_ImageTracking'|translate|e('html_attr') }}"
     anchor="imageTracking">
    <a name="image-tracking-link"></a>

    <div id="image-tracking-code-options" ng-controller="ImageTrackingCodeController as imageTrackingCode">

        <p>
            {{ 'CoreAdminHome_ImageTrackingIntro1'|translate }} {{ 'CoreAdminHome_ImageTrackingIntro2'|translate("<code>&lt;noscript&gt;&lt;/noscript&gt;</code>")|raw }}
        </p>
        <p>
            {{ 'CoreAdminHome_ImageTrackingIntro3'|translate('<a href="https://matomo.org/docs/tracking-api/reference/" rel="noreferrer noopener" target="_blank">','</a>')|raw }}
        </p>

        {# website #}
        <div piwik-field uicontrol="site" name="image-tracker-website"
             ng-model="imageTrackingCode.site"
             ng-change="imageTrackingCode.changeSite(true)"
             introduction="{{ 'General_Website'|translate|e('html_attr') }}"
             value='{{ defaultSite|json_encode }}'>
        </div>

        {# action_name #}
        <div piwik-field uicontrol="text" name="image-tracker-action-name"
             ng-model="imageTrackingCode.pageName"
             ng-change="imageTrackingCode.updateTrackingCode()"
             data-disabled="imageTrackingCode.isLoading"
             introduction="{{ 'General_Options'|translate|e('html_attr') }}"
             data-title="{{ 'Actions_ColumnPageName'|translate|e('html_attr') }}"
             value="">
        </div>

        {# goal #}
        <div piwik-field uicontrol="checkbox" name="image-tracking-goal-check"
             ng-model="imageTrackingCode.trackGoal"
             ng-change="imageTrackingCode.updateTrackingCode()"
             data-disabled="imageTrackingCode.isLoading"
             data-title="{{ 'CoreAdminHome_TrackAGoal'|translate|e('html_attr') }}"
             value="">
        </div>

        <div ng-show="imageTrackingCode.trackGoal"
             id="image-tracking-goal-sub">
            <div class="row">
                <div class="col s12 m6">
                    <div piwik-field uicontrol="select" name="image-tracker-goal"
                         options="imageTrackingCode.allGoals"
                         data-disabled="imageTrackingCode.isLoading"
                         ng-model="imageTrackingCode.trackIdGoal"
                         full-width="true"
                         ng-change="imageTrackingCode.updateTrackingCode()"
                         value="">
                    </div>
                </div>
                <div class="col s12 m6">
                    <div piwik-field uicontrol="text" name="image-revenue"
                         ng-model="imageTrackingCode.revenue"
                         ng-change="imageTrackingCode.updateTrackingCode()"
                         data-disabled="imageTrackingCode.isLoading"
                         full-width="true"
                         data-title="{{ 'CoreAdminHome_WithOptionalRevenue'|translate|e('html_attr') }} <span class='site-currency'></span>"
                         value="">
                    </div>
                </div>
            </div>
        </div>

        <div id="image-link-output-section">
            <h3>{{ 'CoreAdminHome_ImageTrackingLink'|translate }}</h3>

            <div id="image-tracking-text">
                <pre piwik-select-on-focus
                          ng-bind="imageTrackingCode.trackingCode"> </pre>
            </div>
        </div>
    </div>
</div>

<div piwik-content-block content-title="{{ 'CoreAdminHome_ImportingServerLogs'|translate|e('html_attr') }}"
     anchor="importServerLogs">
    <p>
        {{ 'CoreAdminHome_ImportingServerLogsDesc'|translate('<a href="https://matomo.org/log-analytics/" rel="noreferrer noopener" target="_blank">','</a>')|raw }}
    </p>
</div>

<div piwik-content-block content-title="{{ 'SitesManager_MobileAppsAndSDKs'|translate }}" anchor="mobileAppsAndSdks">
    <p>{{ 'SitesManager_MobileAppsAndSDKsDescription'|translate('<a href="https://matomo.org/integrate/#programming-language-platforms-and-frameworks" rel="noreferrer noopener" target="_blank">','</a>')|raw }}</p>
</div>

<div piwik-content-block content-title="{{ 'CoreAdminHome_HttpTrackingApi'|translate }}" anchor="trackingApi">
    <p>{{ 'CoreAdminHome_HttpTrackingApiDescription'|translate('<a href="https://developer.matomo.org/api-reference/tracking-api" rel="noreferrer noopener" target="_blank">','</a>')|raw }}</p>
</div>

{{ postEvent('Template.endTrackingCodePage') }}

{% endblock %}
