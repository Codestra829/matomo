(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["SitesManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["SitesManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/SitesManager/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"SiteTypesStore",(function(){return p})),n.d(t,"SiteFields",(function(){return Ce})),n.d(t,"CurrencyStore",(function(){return Ee})),n.d(t,"TimezoneStore",(function(){return ge})),"undefined"!==typeof window){var r=window.document.currentScript,i=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var a=n("19dc"),o=n("8bbf");function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var d=window,m=d.$,b=function(){function e(){var t=this;l(this,e),u(this,"state",Object(o["reactive"])({typesById:{}})),u(this,"typesById",Object(o["computed"])((function(){return Object(o["readonly"])(t.state).typesById}))),u(this,"types",Object(o["computed"])((function(){return Object.values(t.typesById.value)}))),u(this,"response",void 0),this.fetchAvailableTypes()}return s(e,[{key:"fetchAvailableTypes",value:function(){var e=this;return this.response?Promise.resolve(this.response):(this.response=a["AjaxHelper"].fetch({method:"API.getAvailableMeasurableTypes",filter_limit:"-1"}).then((function(t){return t.forEach((function(t){e.state.typesById[t.id]=t})),e.types.value})),this.response)}},{key:"getEditSiteIdParameter",value:function(){var e=a["MatomoUrl"].hashParsed.value.editsiteid;if(e&&m.isNumeric(e))return e}},{key:"removeEditSiteIdParameterFromHash",value:function(){var e=Object.assign({},a["MatomoUrl"].hashParsed.value);delete e.editsiteid,a["MatomoUrl"].updateHash(e)}}]),e}(),p=Object(a["lazyInitSingleton"])(b);
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function f(){return{get typesById(){return Object(a["clone"])(p.typesById.value)},fetchTypeById:function(e){var t=this;return p.fetchAvailableTypes().then((function(){return Object(a["cloneThenApply"])(t.typesById[e])}))},fetchAvailableTypes:function(){return p.fetchAvailableTypes().then((function(e){return Object(a["cloneThenApply"])(e)}))},hasMultipleTypes:function(){return p.fetchAvailableTypes().then((function(e){return e&&Object.keys(e).length>1}))},removeEditSiteIdParameterFromHash:p.removeEditSiteIdParameterFromHash.bind(p),getEditSiteIdParameter:p.getEditSiteIdParameter.bind(p)}}window.angular.module("piwikApp.service").factory("sitesManagerTypeModel",f);var h=["idsite","type"],g={class:"card-content"},j={key:0,class:"row"},S={class:"col m3"},y={class:"title"},O={class:"title"},v=["target","title","href"],E={class:"col m4"},V={class:"title"},N={class:"title"},T={class:"title"},w={class:"title"},_={class:"col m4"},M={class:"title"},x=Object(o["createTextVNode"])(": "),k=["href"],D={key:0},C={class:"title"},A={key:1},I={class:"title"},B={key:2},P={class:"title"},z={class:"col m1 text-right"},U=["title"],H=Object(o["createElementVNode"])("span",{class:"icon-edit"},null,-1),F=[H],G=["title"],$=Object(o["createElementVNode"])("span",{class:"icon-delete"},null,-1),q=[$],L={key:1},J={class:"form-group row"},Y={class:"col s12 m6 input-field"},R=["placeholder"],W=Object(o["createElementVNode"])("div",{class:"col s12 m6"},null,-1),K={id:"timezoneHelpText",class:"inline-help-node"},Q={key:0},X=Object(o["createElementVNode"])("br",null,null,-1),Z=Object(o["createElementVNode"])("br",null,null,-1),ee={class:"editingSiteFooter"},te=["value"],ne=["value"],re=["value"];function ie(e,t,n,r,i,a){var l=this,c=Object(o["resolveComponent"])("ActivityIndicator"),s=Object(o["resolveComponent"])("GroupedSettings"),u=Object(o["resolveComponent"])("Field"),d=Object(o["resolveComponent"])("MatomoDialog");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(["site card hoverable",{editingSite:!!e.editMode}]),idsite:e.theSite.idsite,type:e.theSite.type},[Object(o["createElementVNode"])("div",g,[e.editMode?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",j,[Object(o["createElementVNode"])("div",S,[Object(o["createElementVNode"])("h4",null,Object(o["toDisplayString"])(e.theSite.name),1),Object(o["createElementVNode"])("ul",null,[Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("span",y,Object(o["toDisplayString"])(e.translate("General_Id"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.theSite.idsite),1)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("span",O,Object(o["toDisplayString"])(e.translate("SitesManager_Type"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.currentType.name),1)],512),[[o["vShow"],e.availableTypes.length>1]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("a",{target:e.isInternalSetupUrl?"_self":"_blank",title:e.translate("SitesManager_ShowTrackingTag"),href:e.setupUrl},Object(o["toDisplayString"])(e.translate("SitesManager_ShowTrackingTag")),9,v)],512),[[o["vShow"],e.theSite.idsite&&e.howToSetupUrl]])])]),Object(o["createElementVNode"])("div",E,[Object(o["createElementVNode"])("ul",null,[Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("span",V,Object(o["toDisplayString"])(e.translate("SitesManager_Timezone"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.theSite.timezone_name),1)]),Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("span",N,Object(o["toDisplayString"])(e.translate("SitesManager_Currency"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.theSite.currency_name),1)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("span",T,Object(o["toDisplayString"])(e.translate("Goals_Ecommerce"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_Yes")),1)],512),[[o["vShow"],1===e.theSite.ecommerce||"1"===e.theSite.ecommerce]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("span",w,Object(o["toDisplayString"])(e.translate("Actions_SubmenuSitesearch"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_Yes")),1)],512),[[o["vShow"],1===e.theSite.sitesearch||"1"===e.theSite.sitesearch]])])]),Object(o["createElementVNode"])("div",_,[Object(o["createElementVNode"])("ul",null,[Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("span",M,Object(o["toDisplayString"])(e.translate("SitesManager_Urls")),1),x,(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.theSite.alias_urls,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:t},[Object(o["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:t},Object(o["toDisplayString"])(t)+Object(o["toDisplayString"])(n===e.theSite.alias_urls.length-1?"":", "),9,k)])})),128))]),e.theSite.excluded_ips.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",D,[Object(o["createElementVNode"])("span",C,Object(o["toDisplayString"])(e.translate("SitesManager_ExcludedIps"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.theSite.excluded_ips),1)])):Object(o["createCommentVNode"])("",!0),e.theSite.excluded_parameters.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",A,[Object(o["createElementVNode"])("span",I,Object(o["toDisplayString"])(e.translate("SitesManager_ExcludedParameters"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.theSite.excluded_parameters),1)])):Object(o["createCommentVNode"])("",!0),e.theSite.excluded_user_agents.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",B,[Object(o["createElementVNode"])("span",P,Object(o["toDisplayString"])(e.translate("SitesManager_ExcludedUserAgents"))+":",1),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.theSite.excluded_user_agents),1)])):Object(o["createCommentVNode"])("",!0)])]),Object(o["createElementVNode"])("div",z,[Object(o["createElementVNode"])("ul",null,[Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("button",{class:"table-action",onClick:t[0]||(t[0]=function(t){return e.editSite()}),title:e.translate("General_Edit")},F,8,U)]),Object(o["createElementVNode"])("li",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("button",{class:"table-action",onClick:t[1]||(t[1]=function(e){return l.showRemoveDialog=!0}),title:e.translate("General_Delete")},q,8,G),[[o["vShow"],e.theSite.idsite]])])])])])),e.editMode?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",L,[Object(o["createElementVNode"])("div",J,[Object(o["createElementVNode"])("div",Y,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.theSite.name=t}),maxlength:"90",placeholder:e.translate("General_Name")},null,8,R),[[o["vModelText"],e.theSite.name]]),Object(o["createElementVNode"])("label",null,Object(o["toDisplayString"])(e.translate("General_Name")),1)]),W]),Object(o["createVNode"])(c,{loading:e.isLoading},null,8,["loading"]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.measurableSettings,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{key:t.pluginName},[Object(o["createVNode"])(s,{"group-name":t.pluginName,settings:t.settings,"all-setting-values":e.settingValues,onChange:function(n){return e.settingValues["".concat(t.pluginName,".").concat(n.name)]=n.value}},null,8,["group-name","settings","all-setting-values","onChange"])])})),128)),Object(o["createVNode"])(u,{uicontrol:"select",name:"currency",modelValue:e.theSite.currency,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.theSite.currency=t}),title:e.translate("SitesManager_Currency"),"inline-help":e.translate("SitesManager_CurrencySymbolWillBeUsedForGoals"),options:e.currencies},null,8,["modelValue","title","inline-help","options"]),Object(o["createVNode"])(u,{uicontrol:"select",name:"timezone",modelValue:e.theSite.timezone,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.theSite.timezone=t}),title:e.translate("SitesManager_Timezone"),"inline-help":"#timezoneHelpText",options:e.timezones},null,8,["modelValue","title","options"]),Object(o["createElementVNode"])("div",K,[Object(o["createElementVNode"])("div",null,[e.timezoneSupportEnabled?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",Q,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("SitesManager_AdvancedTimezoneSupportNotFound"))+" ",1),X])),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.utcTimeIs)+" ",1),Z,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("SitesManager_ChangingYourTimezoneWillOnlyAffectDataForward")),1)])]),Object(o["createElementVNode"])("div",ee,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"submit",class:"btn",value:e.translate("General_Save"),onClick:t[5]||(t[5]=function(t){return e.saveSite()})},null,8,te),[[o["vShow"],!e.isLoading]]),Object(o["createElementVNode"])("button",{class:"btn btn-link",onClick:t[6]||(t[6]=function(t){return e.cancelEditSite(e.site)})},Object(o["toDisplayString"])(e.translate("General_Cancel","","")),1)])])):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])(d,{class:"ui-confirm",modelValue:e.showRemoveDialog,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.showRemoveDialog=t}),onYes:t[8]||(t[8]=function(t){return e.deleteSite()})},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.removeDialogTitle),1),Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("SitesManager_DeleteSiteExplanation")),1),Object(o["createElementVNode"])("input",{type:"button",value:e.translate("General_Yes"),role:"yes"},null,8,ne),Object(o["createElementVNode"])("input",{type:"button",value:e.translate("General_No"),role:"no"},null,8,re)]})),_:1},8,["modelValue"])],10,h)}var ae=n("a5a2");function oe(e,t){return de(e)||ue(e,t)||ce(e,t)||le()}function le(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ce(e,t){if(e){if("string"===typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(e,t):void 0}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ue(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done);o=!0)if(a.push(r.value),t&&a.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return a}}function de(e){if(Array.isArray(e))return e}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t,n){return t&&be(e.prototype,t),n&&be(e,n),e}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var he=function(){function e(){var t=this;me(this,e),fe(this,"privateState",Object(o["reactive"])({timezones:[]})),fe(this,"timezones",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState).timezones}))),this.fetchTimezones()}return pe(e,[{key:"fetchTimezones",value:function(){var e=this;a["AjaxHelper"].fetch({method:"SitesManager.getTimezonesList"}).then((function(t){var n=[];Object.entries(t).forEach((function(e){var t=oe(e,2),r=t[0],i=t[1];Object.entries(i).forEach((function(e){var t=oe(e,2),i=t[0],a=t[1];n.push({group:r,label:i,code:a})}))})),e.privateState.timezones=n}))}}]),e}(),ge=Object(a["lazyInitSingleton"])(he);function je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t,n){return t&&Se(e.prototype,t),n&&Se(e,n),e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var ve=function(){function e(){var t=this;je(this,e),Oe(this,"privateState",Object(o["reactive"])({currencies:{}})),Oe(this,"currencies",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState).currencies}))),this.fetchCurrencies()}return ye(e,[{key:"fetchCurrencies",value:function(){var e=this;a["AjaxHelper"].fetch({method:"SitesManager.getCurrencyList"}).then((function(t){e.privateState.currencies=t}))}}]),e}(),Ee=Object(a["lazyInitSingleton"])(ve);function Ve(e,t){return Me(e)||_e(e,t)||Te(e,t)||Ne()}function Ne(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Te(e,t){if(e){if("string"===typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _e(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done);o=!0)if(a.push(r.value),t&&a.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return a}}function Me(e){if(Array.isArray(e))return e}var xe=Object(o["computed"])((function(){return ge.timezones.value.map((function(e){var t=e.group,n=e.label,r=e.code;return{group:t,key:n,value:r}}))}));function ke(e){return"undefined"===typeof e.idsite}var De=Object(o["defineComponent"])({props:{site:{type:Object,required:!0},timezoneSupportEnabled:{type:Boolean},utcTime:{type:Date,required:!0},globalSettings:{type:Object,required:!0}},data:function(){return{isLoading:!1,editMode:!1,theSite:Object.assign({},this.site),measurableSettings:[],settingValues:{},showRemoveDialog:!1}},components:{MatomoDialog:a["MatomoDialog"],Field:ae["Field"],GroupedSettings:ae["GroupedSettings"],ActivityIndicator:a["ActivityIndicator"]},emits:["delete","cancelEditSite","save"],created:function(){this.onSiteChanged()},watch:{site:function(){this.onSiteChanged()},measurableSettings:function(e){if(e.length){var t={};e.forEach((function(e){e.settings.forEach((function(n){t["".concat(e.pluginName,".").concat(n.name)]=n.value}))})),this.settingValues=t}}},methods:{onSiteChanged:function(){var e=this.site;this.theSite=Object.assign({},e);var t=ke(e);if(t){var n=this.globalSettings;this.theSite.timezone=n.defaultTimezone,this.theSite.currency=n.defaultCurrency}var r=p.getEditSiteIdParameter();(t||r&&"".concat(e.idsite)===r)&&this.editSite()},editSite:function(){var e=this;if(this.editMode=!0,this.measurableSettings=[],ke(this.theSite)){if(!this.currentType)return;this.measurableSettings=this.currentType.settings||[]}else this.isLoading=!0,a["AjaxHelper"].fetch({method:"SitesManager.getSiteSettings",idSite:this.theSite.idsite}).then((function(t){e.measurableSettings=t})).finally((function(){e.isLoading=!1}))},saveSite:function(){var e=this,t={siteName:this.theSite.name,timezone:this.theSite.timezone,currency:this.theSite.currency,type:this.theSite.type,settingValues:{}},n=ke(this.theSite),r="SitesManager.addSite";n||(r="SitesManager.updateSite",t.idSite=this.theSite.idsite),Object.entries(this.settingValues).forEach((function(e){var n=Ve(e,2),r=n[0],i=n[1],a=r.split("."),o=Ve(a,2),l=o[0],c=o[1],s=t.settingValues;s[l]||(s[l]=[]);var u=i;!1===i?u="0":!0===i?u="1":Array.isArray(i)&&(u=i.filter((function(e){return!!e}))),s[l].push({name:c,value:u})})),a["AjaxHelper"].post({method:r},t).then((function(r){e.editMode=!1,!e.theSite.idsite&&r&&r.value&&(e.theSite.idsite=r.value);var i=a["NotificationsStore"].show({message:n?Object(a["translate"])("SitesManager_WebsiteCreated"):Object(a["translate"])("SitesManager_WebsiteUpdated"),context:"success",id:"websitecreated",type:"transient"});a["NotificationsStore"].scrollToNotification(i),p.removeEditSiteIdParameterFromHash(),e.$emit("save",{site:e.theSite,settingValues:t.settingValues})}))},cancelEditSite:function(e){this.editMode=!1,p.removeEditSiteIdParameterFromHash(),this.$emit("cancelEditSite",e)},deleteSite:function(){var e=this;a["AjaxHelper"].fetch({idSite:this.theSite.idsite,module:"API",format:"json",method:"SitesManager.deleteSite"}).then((function(){e.$emit("delete",e.theSite)}))}},computed:{availableTypes:function(){return p.types.value},setupUrl:function(){var e=this.theSite,t="";return this.isInternalSetupUrl&&(t=a["MatomoUrl"].stringify({idSite:e.idsite,period:a["MatomoUrl"].parsed.value.period,date:a["MatomoUrl"].parsed.value.date,updated:"false"})),"".concat(this.howToSetupUrl).concat(t)},utcTimeIs:function(){var e=this.utcTime,t=function(e){return e.toString().padStart(2,"0")},n=t(e.getHours()),r=t(e.getMinutes()),i=t(e.getSeconds()),o="".concat(Object(a["format"])(this.utcTime)," ").concat(n,":").concat(r,":").concat(i);return Object(a["translate"])("SitesManager_UTCTimeIs",o)},timezones:function(){return xe.value},currencies:function(){return Ee.currencies.value},currentType:function(){var e=this.site,t=p.typesById.value[e.type];return t||{name:e.type}},howToSetupUrl:function(){var e=this.currentType;if(e)return e.howToSetupUrl},isInternalSetupUrl:function(){var e=this.howToSetupUrl;return!!e&&"?"==="".concat(e).substring(0,1)},removeDialogTitle:function(){return Object(a["translate"])("SitesManager_DeleteConfirm",'"'.concat(this.theSite.name,'" (idSite = ').concat(this.theSite.idsite,")"))}}});De.render=ie;var Ce=De;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */Object(a["createAngularJsAdapter"])({component:Ce,scope:{site:{angularJsBind:"<"},timezoneSupportEnabled:{angularJsBind:"<"},utcTime:{angularJsBind:"<"},globalSettings:{angularJsBind:"<"}},directiveName:"matomoSiteFields",$inject:["$timeout"],events:{delete:function(e,t,n){var r=n.redirectParams;if(a["MatomoUrl"].urlParsed.value.idSite===e.idsite){var i=n.adminSites.sites,o=i.find((function(t){return t.idsite!==e.idsite}));o&&(r=Object.assign(Object.assign({},r),{},{idSite:o.idsite}))}a["MatomoUrl"].updateUrl(Object.assign(Object.assign({},a["MatomoUrl"].urlParsed.value),{},{redirectParams:r}),a["MatomoUrl"].hashParsed.value)},save:function(e,t,n,r,i,a,o){var l=e.site,c=e.settingValues,s=["excluded_ips","excluded_parameters","excluded_user_agents","sitesearch_keyword_parameters","sitesearch_category_parameters"],u=Object.assign({},l);Object.values(c).forEach((function(e){e.forEach((function(e){"urls"===e.name?u.alias_urls=e.value:-1!==s.indexOf(e.name)?u[e.name]=e.value.join(", "):u[e.name]=e.value}))})),window.$.extend(n.site,u),o(),t.site=u}}})}})}));
//# sourceMappingURL=SitesManager.umd.min.js.map