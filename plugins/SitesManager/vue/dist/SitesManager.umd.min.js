(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["SitesManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["SitesManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/SitesManager/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"SiteTypesStore",(function(){return f})),n.d(t,"CurrencyStore",(function(){return et})),n.d(t,"TimezoneStore",(function(){return Qe})),n.d(t,"SitesManagement",(function(){return xt})),n.d(t,"ManageGlobalSettings",(function(){return Qt})),"undefined"!==typeof window){var a=window.document.currentScript,r=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var i=n("8bbf"),l=n("19dc");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var m=window,p=m.$,g=function(){function e(){var t=this;s(this,e),b(this,"state",Object(i["reactive"])({isLoading:!1,typesById:{}})),b(this,"typesById",Object(i["computed"])((function(){return Object(i["readonly"])(t.state).typesById}))),b(this,"isLoading",Object(i["computed"])((function(){return Object(i["readonly"])(t.state).isLoading}))),b(this,"response",void 0),this.fetchAvailableTypes()}return d(e,[{key:"fetchAvailableTypes",value:function(){var e=this;return this.response?Promise.resolve(this.response):(this.state.isLoading=!0,this.response=l["AjaxHelper"].fetch({method:"API.getAvailableMeasurableTypes",filter_limit:"-1"}).then((function(t){return t.forEach((function(t){e.state.typesById[t.id]=t})),e.typesById.value})).finally((function(){e.state.isLoading=!1})),this.response)}},{key:"getEditSiteIdParameter",value:function(){var e=l["MatomoUrl"].hashParsed.value.editsiteid;if(e&&p.isNumeric(e)&&!l["MatomoUrl"].hashParsed.value.showaddsite)return e}},{key:"removeEditSiteIdParameterFromHash",value:function(){var e=c({},l["MatomoUrl"].hashParsed.value);delete e.editsiteid,l["MatomoUrl"].updateHash(e)}}]),e}(),f=Object(l["lazyInitSingleton"])(g);
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function h(){return{get typesById(){return f.typesById.value},fetchTypeById:function(e){return f.fetchAvailableTypes().then((function(t){return t[e]}))},fetchAvailableTypes:function(){return f.fetchAvailableTypes()},hasMultipleTypes:function(){return f.fetchAvailableTypes().then((function(e){return e&&Object.keys(e).length>1}))},removeEditSiteIdParameterFromHash:f.removeEditSiteIdParameterFromHash.bind(f),getEditSiteIdParameter:f.getEditSiteIdParameter.bind(f)}}window.angular.module("piwikApp.service").factory("sitesManagerTypeModel",h);var S={class:"SitesManager",ref:"root"},O={class:"sites-manager-header"},j=["innerHTML"],y=Object(i["createElementVNode"])("br",null,null,-1),v=["innerHTML"],E={class:"loadingPiwik"},N=["alt"],V={class:"center"},x=["title","onClick"],T={class:"ui-button-text"},P={class:"sitesManagerList"},w={key:0},M={class:"bottomButtonBar"};function C(e,t,n,a,r,l){var o=Object(i["resolveComponent"])("EnrichedHeadline"),c=Object(i["resolveComponent"])("AddSiteLink"),s=Object(i["resolveComponent"])("MatomoDialog"),u=Object(i["resolveComponent"])("SiteFields"),d=Object(i["resolveDirective"])("content-intro");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",S,[Object(i["createElementVNode"])("div",O,[Object(i["withDirectives"])(Object(i["createElementVNode"])("div",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("h2",null,[Object(i["createVNode"])(o,{"help-url":"https://matomo.org/docs/manage-websites/","feature-name":e.translate("SitesManager_WebsitesManagement")},{default:Object(i["withCtx"])((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.headlineText),1)]})),_:1},8,["help-url","feature-name"])],512),[[i["vShow"],e.availableTypes.length]]),Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("SitesManager_MainDescription"))+" ",1),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.mainDescription)},null,8,j),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",null,[y,Object(i["createElementVNode"])("span",{innerHTML:e.superUserAccessMessage},null,8,v)],512),[[i["vShow"],e.hasSuperUserAccess]])])],512),[[d]])]),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",{class:Object(i["normalizeClass"])({hide_only:!e.isLoading})},[Object(i["createElementVNode"])("div",E,[Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif",alt:e.translate("General_LoadingData")},null,8,N),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_LoadingData")),1)])],2)]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(c,{"site-is-being-edited":e.isSiteBeingEdited,"has-prev":e.hasPrev,hasNext:e.hasNext,"offset-start":e.offsetStart,"offset-end":e.offsetEnd,"total-number-of-sites":e.totalNumberOfSites,"is-searching":!!e.searchTerm,"is-loading":e.isLoading,onAdd:t[0]||(t[0]=function(t){return e.addNewEntity()}),onSearch:t[1]||(t[1]=function(t){return e.searchSites(t)}),onPrev:t[2]||(t[2]=function(t){return e.previousPage()}),onNext:t[3]||(t[3]=function(t){return e.nextPage()})},null,8,["site-is-being-edited","has-prev","hasNext","offset-start","offset-end","total-number-of-sites","is-searching","is-loading"])]),Object(i["createVNode"])(s,{modelValue:e.showAddSiteDialog,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.showAddSiteDialog=t}),class:"ui-confirm"},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("SitesManager_ChooseMeasurableTypeHeadline")),1),Object(i["createElementVNode"])("div",V,[Object(i["createElementVNode"])("p",null,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.availableTypes,(function(t){return Object(i["openBlock"])(),Object(i["createElementBlock"])("button",{type:"button",key:t.id,title:t.description,class:"modal-close btn",style:{"margin-left":"20px"},onClick:function(n){e.addSite(t.id)},"aria-disabled":"false"},[Object(i["createElementVNode"])("span",T,Object(i["toDisplayString"])(t.name),1)],8,x)})),128))])])])]})),_:1},8,["modelValue"]),Object(i["createElementVNode"])("div",P,[e.searchTerm&&0===e.sites.length&&!e.isLoading?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",w,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("SitesManager_NotFound"))+" ",1),Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.searchTerm),1)])):Object(i["createCommentVNode"])("",!0),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.sites,(function(n,a){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:n.idsite},[Object(i["createVNode"])(u,{site:n,"timezone-support-enabled":e.timezoneSupportEnabled,"utc-time":e.utcTime,"global-settings":e.globalSettings,onCancelEditSite:t[5]||(t[5]=function(t){return e.afterCancelEdit(t)}),onDelete:t[6]||(t[6]=function(t){return e.afterDelete(t)}),onSave:function(t){return e.afterSave(t.site,t.settingValues,a)}},null,8,["site","timezone-support-enabled","utc-time","global-settings","onSave"])])})),128))]),Object(i["createElementVNode"])("div",M,[Object(i["createVNode"])(c,{"site-is-being-edited":e.isSiteBeingEdited,"has-prev":e.hasPrev,hasNext:e.hasNext,"offset-start":e.offsetStart,"offset-end":e.offsetEnd,"total-number-of-sites":e.totalNumberOfSites,"is-searching":!!e.searchTerm,"is-loading":e.isLoading,onAdd:t[7]||(t[7]=function(t){return e.addNewEntity()}),onSearch:t[8]||(t[8]=function(t){return e.searchSites(t)}),onPrev:t[9]||(t[9]=function(t){return e.previousPage()}),onNext:t[10]||(t[10]=function(t){return e.nextPage()})},null,8,["site-is-being-edited","has-prev","hasNext","offset-start","offset-end","total-number-of-sites","is-searching","is-loading"])])],512)}var D={class:"sitesButtonBar clearfix"},A={class:"search"},_=["placeholder"],k=["title"],G={class:"paging"},U=["disabled"],L={style:{cursor:"pointer"}},I={class:"counter","ng-show":"adminSites.hasPrev || adminSites.hasNext"},B={key:0},z={key:1},H=["disabled"],F={style:{cursor:"pointer"},class:"pointer"};function R(e,t,n,a,r,l){return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",D,[Object(i["withDirectives"])(Object(i["createElementVNode"])("a",{class:"btn addSite",onClick:t[0]||(t[0]=function(t){return e.addNewEntity()}),tabindex:"1"},Object(i["toDisplayString"])(e.availableTypes.length>1?e.translate("SitesManager_AddMeasurable"):e.translate("SitesManager_AddSite")),513),[[i["vShow"],e.hasSuperUserAccess&&e.availableTypes]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",A,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchTerm=t}),onKeydown:t[2]||(t[2]=function(t){return e.searchSiteOnEnter(t)}),placeholder:e.translate("Actions_SubmenuSitesearch"),type:"text"},null,40,_),[[i["vModelText"],e.searchTerm]]),Object(i["createElementVNode"])("img",{onClick:t[3]||(t[3]=function(t){return e.searchSite()}),title:e.translate("General_ClickToSearch"),class:"search_ico",src:"plugins/Morpheus/images/search_ico.png"},null,8,k)],512),[[i["vShow"],e.hasPrev||e.hasNext||e.isSearching]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",G,[Object(i["createElementVNode"])("a",{class:"btn prev",disabled:!(e.hasPrev&&!e.isLoading)||void 0,onClick:t[4]||(t[4]=function(t){return e.previousPage()})},[Object(i["createElementVNode"])("span",L,"« "+Object(i["toDisplayString"])(e.translate("General_Previous")),1)],8,U),Object(i["createElementVNode"])("span",I,[e.isSearching?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",B,Object(i["toDisplayString"])(e.translate("General_PaginationWithoutTotal",e.offsetStart,e.offsetEnd)),1)):Object(i["createCommentVNode"])("",!0),e.isSearching?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",z,Object(i["toDisplayString"])(e.translate("General_Pagination",e.offsetStart,e.offsetEnd,null===e.totalNumberOfSites?"?":e.totalNumberOfSites)),1))]),Object(i["createElementVNode"])("a",{class:"btn next",disabled:!(e.hasNext&&!e.isLoading)||void 0,onClick:t[5]||(t[5]=function(t){return e.nextPage()})},[Object(i["createElementVNode"])("span",F,Object(i["toDisplayString"])(e.translate("General_Next"))+" »",1)],8,H)],512),[[i["vShow"],e.hasPrev||e.hasNext]])],512)),[[i["vShow"],!e.siteIsBeingEdited]])}var W=Object(i["defineComponent"])({props:{siteIsBeingEdited:{type:Boolean,required:!0},hasPrev:{type:Boolean,required:!0},hasNext:{type:Boolean,required:!0},offsetStart:{type:Number,required:!0},offsetEnd:{type:Number,required:!0},totalNumberOfSites:{type:Number},isSearching:{type:Boolean,required:!0},isLoading:{type:Boolean,required:!0}},data:function(){return{searchTerm:""}},emits:["add","search","prev","next"],computed:{hasSuperUserAccess:function(){return l["Matomo"].hasSuperUserAccess},availableTypes:function(){return f.typesById.value}},methods:{addNewEntity:function(){this.$emit("add")},searchSite:function(){this.$emit("search",this.searchTerm)},previousPage:function(){this.$emit("prev")},nextPage:function(){this.$emit("next")},searchSiteOnEnter:function(e){"Enter"===e.key&&(e.preventDefault(),this.searchSite())}}});W.render=R;var K=W,q=["idsite","type"],Q={class:"card-content"},$={key:0,class:"row"},Y={class:"col m3"},J={class:"title"},X={class:"title"},Z=["target","title","href"],ee={class:"col m4"},te={class:"title"},ne={class:"title"},ae={class:"title"},re={class:"title"},ie={class:"col m4"},le={class:"title"},oe=Object(i["createTextVNode"])(": "),ce=["href"],se={key:0},ue={class:"title"},de={key:1},be={class:"title"},me={key:2},pe={class:"title"},ge={class:"col m1 text-right"},fe=["title"],he=Object(i["createElementVNode"])("span",{class:"icon-edit"},null,-1),Se=[he],Oe=["title"],je=Object(i["createElementVNode"])("span",{class:"icon-delete"},null,-1),ye=[je],ve={key:1},Ee={class:"form-group row"},Ne={class:"col s12 m6 input-field"},Ve=["placeholder"],xe=Object(i["createElementVNode"])("div",{class:"col s12 m6"},null,-1),Te={id:"timezoneHelpText",class:"inline-help-node"},Pe={key:0},we=Object(i["createElementVNode"])("br",null,null,-1),Me=Object(i["createElementVNode"])("br",null,null,-1),Ce={class:"editingSiteFooter"},De=["value"],Ae=["value"],_e=["value"];function ke(e,t,n,a,r,l){var o,c,s,u=this,d=Object(i["resolveComponent"])("ActivityIndicator"),b=Object(i["resolveComponent"])("PluginSetting"),m=Object(i["resolveComponent"])("Field"),p=Object(i["resolveComponent"])("MatomoDialog");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])(["site card hoverable",{editingSite:!!e.editMode}]),idsite:e.theSite.idsite,type:e.theSite.type,ref:"root"},[Object(i["createElementVNode"])("div",Q,[e.editMode?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",$,[Object(i["createElementVNode"])("div",Y,[Object(i["createElementVNode"])("h4",null,Object(i["toDisplayString"])(e.theSite.name),1),Object(i["createElementVNode"])("ul",null,[Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("span",J,Object(i["toDisplayString"])(e.translate("General_Id"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.theSite.idsite),1)]),Object(i["withDirectives"])(Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("span",X,Object(i["toDisplayString"])(e.translate("SitesManager_Type"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.currentType.name),1)],512),[[i["vShow"],e.availableTypes.length>1]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("a",{target:e.isInternalSetupUrl?"_self":"_blank",title:e.translate("SitesManager_ShowTrackingTag"),href:e.setupUrl},Object(i["toDisplayString"])(e.translate("SitesManager_ShowTrackingTag")),9,Z)],512),[[i["vShow"],e.theSite.idsite&&e.howToSetupUrl]])])]),Object(i["createElementVNode"])("div",ee,[Object(i["createElementVNode"])("ul",null,[Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("span",te,Object(i["toDisplayString"])(e.translate("SitesManager_Timezone"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.theSite.timezone_name),1)]),Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("span",ne,Object(i["toDisplayString"])(e.translate("SitesManager_Currency"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.theSite.currency_name),1)]),Object(i["withDirectives"])(Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("span",ae,Object(i["toDisplayString"])(e.translate("Goals_Ecommerce"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_Yes")),1)],512),[[i["vShow"],1===e.theSite.ecommerce]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("span",re,Object(i["toDisplayString"])(e.translate("Actions_SubmenuSitesearch"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_Yes")),1)],512),[[i["vShow"],1==e.theSite.sitesearch]])])]),Object(i["createElementVNode"])("div",ie,[Object(i["createElementVNode"])("ul",null,[Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("span",le,Object(i["toDisplayString"])(e.translate("SitesManager_Urls")),1),oe,(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.theSite.alias_urls,(function(t,n){return Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:t},[Object(i["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:t},Object(i["toDisplayString"])(t)+Object(i["toDisplayString"])(n===e.theSite.alias_urls.length-1?"":", "),9,ce)])})),128))]),null!==(o=e.theSite.excluded_ips)&&void 0!==o&&o.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("li",se,[Object(i["createElementVNode"])("span",ue,Object(i["toDisplayString"])(e.translate("SitesManager_ExcludedIps"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.theSite.excluded_ips),1)])):Object(i["createCommentVNode"])("",!0),null!==(c=e.theSite.excluded_parameters)&&void 0!==c&&c.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("li",de,[Object(i["createElementVNode"])("span",be,Object(i["toDisplayString"])(e.translate("SitesManager_ExcludedParameters"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.theSite.excluded_parameters),1)])):Object(i["createCommentVNode"])("",!0),null!==(s=e.theSite.excluded_user_agents)&&void 0!==s&&s.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("li",me,[Object(i["createElementVNode"])("span",pe,Object(i["toDisplayString"])(e.translate("SitesManager_ExcludedUserAgents"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.theSite.excluded_user_agents),1)])):Object(i["createCommentVNode"])("",!0)])]),Object(i["createElementVNode"])("div",ge,[Object(i["createElementVNode"])("ul",null,[Object(i["createElementVNode"])("li",null,[Object(i["createElementVNode"])("button",{class:"table-action",onClick:t[0]||(t[0]=function(t){return e.editSite()}),title:e.translate("General_Edit")},Se,8,fe)]),Object(i["createElementVNode"])("li",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("button",{class:"table-action",onClick:t[1]||(t[1]=function(e){return u.showRemoveDialog=!0}),title:e.translate("General_Delete")},ye,8,Oe),[[i["vShow"],e.theSite.idsite]])])])])])),e.editMode?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ve,[Object(i["createElementVNode"])("div",Ee,[Object(i["createElementVNode"])("div",Ne,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.theSite.name=t}),maxlength:"90",placeholder:e.translate("General_Name")},null,8,Ve),[[i["vModelText"],e.theSite.name]]),Object(i["createElementVNode"])("label",null,Object(i["toDisplayString"])(e.translate("General_Name")),1)]),xe]),Object(i["createVNode"])(d,{loading:e.isLoading},null,8,["loading"]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.measurableSettings,(function(t){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:t.plugin},[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t.settings,(function(n){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:"".concat(t.pluginName,".").concat(n.name)},[Object(i["createVNode"])(b,{modelValue:e.settingValues["".concat(t.pluginName,".").concat(n.name)],"onUpdate:modelValue":function(a){return e.settingValues["".concat(t.pluginName,".").concat(n.name)]=a},"plugin-name":t.pluginName,setting:n,"setting-values":e.settingValues},null,8,["modelValue","onUpdate:modelValue","plugin-name","setting","setting-values"])])})),128))])})),128)),Object(i["createVNode"])(m,{uicontrol:"select",name:"currency",modelValue:e.theSite.currency,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.theSite.currency=t}),title:e.translate("SitesManager_Currency"),"inline-help":e.translate("SitesManager_CurrencySymbolWillBeUsedForGoals"),options:e.currencies},null,8,["modelValue","title","inline-help","options"]),Object(i["createVNode"])(m,{uicontrol:"select",name:"timezone",modelValue:e.theSite.timezone,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.theSite.timezone=t}),title:e.translate("SitesManager_Timezone"),"inline-help":"#timezoneHelpText",options:e.timezones},null,8,["modelValue","title","options"]),Object(i["createElementVNode"])("div",Te,[Object(i["createElementVNode"])("div",null,[e.timezoneSupportEnabled?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Pe,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("SitesManager_AdvancedTimezoneSupportNotFound"))+" ",1),we])),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.utcTimeIs)+" ",1),Me,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("SitesManager_ChangingYourTimezoneWillOnlyAffectDataForward")),1)])]),Object(i["createElementVNode"])("div",Ce,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"submit",class:"btn",value:e.translate("General_Save"),onClick:t[5]||(t[5]=function(t){return e.saveSite()})},null,8,De),[[i["vShow"],!e.isLoading]]),Object(i["createElementVNode"])("button",{class:"btn btn-link",onClick:t[6]||(t[6]=function(t){return e.cancelEditSite(e.site)})},Object(i["toDisplayString"])(e.translate("General_Cancel","","")),1)])])):Object(i["createCommentVNode"])("",!0)]),Object(i["createVNode"])(p,{class:"ui-confirm",modelValue:e.showRemoveDialog,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.showRemoveDialog=t}),onYes:t[8]||(t[8]=function(t){return e.deleteSite()})},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.removeDialogTitle),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("SitesManager_DeleteSiteExplanation")),1),Object(i["createElementVNode"])("input",{type:"button",value:e.translate("General_Yes"),role:"yes"},null,8,Ae),Object(i["createElementVNode"])("input",{type:"button",value:e.translate("General_No"),role:"no"},null,8,_e)]})),_:1},8,["modelValue"])],10,q)}var Ge=n("a5a2");function Ue(e,t){return He(e)||ze(e,t)||Ie(e,t)||Le()}function Le(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ie(e,t){if(e){if("string"===typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(e,t):void 0}}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ze(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],l=!0,o=!1;try{for(n=n.call(e);!(l=(a=n.next()).done);l=!0)if(i.push(a.value),t&&i.length===t)break}catch(c){o=!0,r=c}finally{try{l||null==n["return"]||n["return"]()}finally{if(o)throw r}}return i}}function He(e){if(Array.isArray(e))return e}function Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Re(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function We(e,t,n){return t&&Re(e.prototype,t),n&&Re(e,n),e}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var qe=function(){function e(){var t=this;Fe(this,e),Ke(this,"privateState",Object(i["reactive"])({isLoading:!1,timezones:[],timezoneSupportEnabled:!1})),Ke(this,"state",Object(i["computed"])((function(){return Object(i["readonly"])(t.privateState)}))),Ke(this,"timezones",Object(i["computed"])((function(){return t.state.value.timezones}))),Ke(this,"timezoneSupportEnabled",Object(i["computed"])((function(){return t.state.value.timezoneSupportEnabled}))),Ke(this,"isLoading",Object(i["computed"])((function(){return t.state.value.isLoading}))),this.privateState.isLoading=!0,Promise.all([this.checkTimezoneSupportEnabled(),this.fetchTimezones()]).finally((function(){t.privateState.isLoading=!1}))}return We(e,[{key:"fetchTimezones",value:function(){var e=this;return l["AjaxHelper"].fetch({method:"SitesManager.getTimezonesList"}).then((function(t){var n=[];Object.entries(t).forEach((function(e){var t=Ue(e,2),a=t[0],r=t[1];Object.entries(r).forEach((function(e){var t=Ue(e,2),r=t[0],i=t[1];n.push({group:a,label:r,code:i})}))})),e.privateState.timezones=n}))}},{key:"checkTimezoneSupportEnabled",value:function(){var e=this;return l["AjaxHelper"].fetch({method:"SitesManager.isTimezoneSupportEnabled"}).then((function(t){e.privateState.timezoneSupportEnabled=t.value}))}}]),e}(),Qe=Object(l["lazyInitSingleton"])(qe);function $e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ye(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Je(e,t,n){return t&&Ye(e.prototype,t),n&&Ye(e,n),e}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Ze=function(){function e(){var t=this;$e(this,e),Xe(this,"privateState",Object(i["reactive"])({isLoading:!1,currencies:{}})),Xe(this,"currencies",Object(i["computed"])((function(){return Object(i["readonly"])(t.privateState).currencies}))),Xe(this,"isLoading",Object(i["computed"])((function(){return Object(i["readonly"])(t.privateState).isLoading}))),this.fetchCurrencies()}return Je(e,[{key:"fetchCurrencies",value:function(){var e=this;this.privateState.isLoading=!0,l["AjaxHelper"].fetch({method:"SitesManager.getCurrencyList"}).then((function(t){e.privateState.currencies=t})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),et=Object(l["lazyInitSingleton"])(Ze);function tt(e,t){return lt(e)||it(e,t)||at(e,t)||nt()}function nt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function at(e,t){if(e){if("string"===typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(e,t):void 0}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function it(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],l=!0,o=!1;try{for(n=n.call(e);!(l=(a=n.next()).done);l=!0)if(i.push(a.value),t&&i.length===t)break}catch(c){o=!0,r=c}finally{try{l||null==n["return"]||n["return"]()}finally{if(o)throw r}}return i}}function lt(e){if(Array.isArray(e))return e}function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){st(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ut=Object(i["computed"])((function(){return Qe.timezones.value.map((function(e){var t=e.group,n=e.label,a=e.code;return{group:t,key:n,value:a}}))}));function dt(e){return"undefined"===typeof e.idsite}var bt=Object(i["defineComponent"])({props:{site:{type:Object,required:!0},timezoneSupportEnabled:{type:Boolean},utcTime:{type:Date,required:!0},globalSettings:{type:Object,required:!0}},data:function(){return{isLoading:!1,editMode:!1,theSite:ct({},this.site),measurableSettings:[],settingValues:{},showRemoveDialog:!1}},components:{MatomoDialog:l["MatomoDialog"],Field:Ge["Field"],PluginSetting:Ge["PluginSetting"],ActivityIndicator:l["ActivityIndicator"]},emits:["delete","cancelEditSite","save"],created:function(){this.onSiteChanged()},watch:{site:function(){this.onSiteChanged()},measurableSettings:function(e){if(e.length){var t={};e.forEach((function(e){e.settings.forEach((function(n){t["".concat(e.pluginName,".").concat(n.name)]=n.value}))})),this.settingValues=t}}},methods:{onSiteChanged:function(){var e=this,t=this.site;this.theSite=ct({},t);var n=dt(t);if(n){var a=this.globalSettings;this.theSite.timezone=a.defaultTimezone,this.theSite.currency=a.defaultCurrency}var r=f.getEditSiteIdParameter();(n||r&&"".concat(t.idsite)===r)&&f.fetchAvailableTypes().then((function(){e.editSite()}))},editSite:function(){var e=this;if(this.editMode=!0,this.measurableSettings=[],dt(this.theSite)){if(!this.currentType)return;this.measurableSettings=this.currentType.settings||[]}else this.isLoading=!0,l["AjaxHelper"].fetch({method:"SitesManager.getSiteSettings",idSite:this.theSite.idsite}).then((function(t){e.measurableSettings=t})).finally((function(){e.isLoading=!1}))},saveSite:function(){var e=this,t={siteName:this.theSite.name,timezone:this.theSite.timezone,currency:this.theSite.currency,type:this.theSite.type,settingValues:{}},n=dt(this.theSite),a="SitesManager.addSite";n||(a="SitesManager.updateSite",t.idSite=this.theSite.idsite),Object.entries(this.settingValues).forEach((function(e){var n=tt(e,2),a=n[0],r=n[1],i=a.split("."),l=tt(i,2),o=l[0],c=l[1],s=t.settingValues;s[o]||(s[o]=[]);var u=r;!1===r?u="0":!0===r?u="1":Array.isArray(r)&&(u=r.filter((function(e){return!!e}))),s[o].push({name:c,value:u})})),l["AjaxHelper"].post({method:a},t).then((function(a){e.editMode=!1,!e.theSite.idsite&&a&&a.value&&(e.theSite.idsite=a.value);var r=Qe.timezones.value.find((function(t){return t.code===e.theSite.timezone}));e.theSite.timezone_name=(null===r||void 0===r?void 0:r.label)||e.theSite.timezone,e.theSite.currency&&(e.theSite.currency_name=et.currencies.value[e.theSite.currency]);var i=l["NotificationsStore"].show({message:n?Object(l["translate"])("SitesManager_WebsiteCreated"):Object(l["translate"])("SitesManager_WebsiteUpdated"),context:"success",id:"websitecreated",type:"transient"});l["NotificationsStore"].scrollToNotification(i),f.removeEditSiteIdParameterFromHash(),e.$emit("save",{site:e.theSite,settingValues:t.settingValues})}))},cancelEditSite:function(e){this.editMode=!1,f.removeEditSiteIdParameterFromHash(),this.$emit("cancelEditSite",{site:e,element:this.$refs.root})},deleteSite:function(){var e=this;l["AjaxHelper"].fetch({idSite:this.theSite.idsite,module:"API",format:"json",method:"SitesManager.deleteSite"}).then((function(){e.$emit("delete",e.theSite)}))}},computed:{availableTypes:function(){return Object.values(f.typesById.value)},setupUrl:function(){var e=this.theSite,t="";return this.isInternalSetupUrl&&(t=l["MatomoUrl"].stringify({idSite:e.idsite,period:l["MatomoUrl"].parsed.value.period,date:l["MatomoUrl"].parsed.value.date,updated:"false"})),"".concat(this.howToSetupUrl).concat(t)},utcTimeIs:function(){var e=this.utcTime,t=function(e){return e.toString().padStart(2,"0")},n=t(e.getHours()),a=t(e.getMinutes()),r=t(e.getSeconds()),i="".concat(Object(l["format"])(this.utcTime)," ").concat(n,":").concat(a,":").concat(r);return Object(l["translate"])("SitesManager_UTCTimeIs",i)},timezones:function(){return ut.value},currencies:function(){return et.currencies.value},currentType:function(){var e=this.site,t=f.typesById.value[e.type];return t||{name:e.type}},howToSetupUrl:function(){var e=this.currentType;if(e)return e.howToSetupUrl},isInternalSetupUrl:function(){var e=this.howToSetupUrl;return!!e&&"?"==="".concat(e).substring(0,1)},removeDialogTitle:function(){return Object(l["translate"])("SitesManager_DeleteConfirm",'"'.concat(this.theSite.name,'" (idSite = ').concat(this.theSite.idsite,")"))}}});bt.render=ke;var mt=bt;function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ht(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function St(e,t,n){return t&&ht(e.prototype,t),n&&ht(e,n),e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var jt=function(){function e(){var t=this;ft(this,e),Ot(this,"privateState",Object(i["reactive"])({isLoading:!1,globalSettings:{keepURLFragmentsGlobal:!1,defaultCurrency:"",defaultTimezone:"",excludedIpsGlobal:"",excludedQueryParametersGlobal:"",excludedUserAgentsGlobal:"",searchKeywordParametersGlobal:"",searchCategoryParametersGlobal:""}})),Ot(this,"isLoading",Object(i["computed"])((function(){return Object(i["readonly"])(t.privateState).isLoading}))),Ot(this,"globalSettings",Object(i["computed"])((function(){return Object(i["readonly"])(t.privateState).globalSettings}))),this.fetchGlobalSettings()}return St(e,[{key:"saveGlobalSettings",value:function(e){var t=this;return this.privateState.isLoading=!0,l["AjaxHelper"].post({module:"SitesManager",format:"json",action:"setGlobalSettings"},e,{withTokenInUrl:!0}).then((function(){t.privateState.globalSettings=gt({},e)})).finally((function(){t.privateState.isLoading=!1}))}},{key:"fetchGlobalSettings",value:function(){var e=this;this.privateState.isLoading=!0,l["AjaxHelper"].fetch({module:"SitesManager",action:"getGlobalSettings"}).then((function(t){e.privateState.globalSettings=gt(gt({},t),{},{excludedIpsGlobal:t.excludedIpsGlobal||"",excludedQueryParametersGlobal:t.excludedQueryParametersGlobal||"",excludedUserAgentsGlobal:t.excludedUserAgentsGlobal||"",searchKeywordParametersGlobal:t.searchKeywordParametersGlobal||"",searchCategoryParametersGlobal:t.searchCategoryParametersGlobal||""})})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),yt=Object(l["lazyInitSingleton"])(jt);function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(n),!0).forEach((function(t){Nt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vt=Object(i["defineComponent"])({props:{dummy:String},components:{MatomoDialog:l["MatomoDialog"],AddSiteLink:K,SiteFields:mt,EnrichedHeadline:l["EnrichedHeadline"]},directives:{ContentIntro:l["ContentIntro"]},data:function(){var e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds());return{pageSize:10,currentPage:0,showAddSiteDialog:!1,searchTerm:"",sites:[],isLoadingInitialEntities:!1,utcTime:t,totalNumberOfSites:null,isSiteBeingEdited:!1,fetchLimitedSitesAbortController:null}},created:function(){var e=this;this.isLoadingInitialEntities=!0,Promise.all([f.fetchAvailableTypes(),this.fetchLimitedSitesWithAdminAccess(),this.getTotalNumberOfSites()]).then((function(){e.triggerAddSiteIfRequested()})).finally((function(){e.isLoadingInitialEntities=!1})),Object(i["watch"])((function(){return l["MatomoUrl"].hashQuery.value}),(function(e){!l["Matomo"].hasSuperUserAccess||"#globalSettings"!==e&&"#/globalSettings"!==e||l["MatomoUrl"].updateLocation(Et(Et({},l["MatomoUrl"].urlParsed.value),{},{action:"globalSettings"}))}))},computed:{isLoading:function(){return!!this.fetchLimitedSitesAbortController||this.isLoadingInitialEntities||null===this.totalNumberOfSites||f.isLoading.value||Qe.isLoading.value||yt.isLoading.value},availableTypes:function(){return Object.values(f.typesById.value)},timezoneSupportEnabled:function(){return Qe.timezoneSupportEnabled.value},globalSettings:function(){return yt.globalSettings.value},headlineText:function(){return Object(l["translate"])("SitesManager_XManagement",this.availableTypes.length>1?Object(l["translate"])("General_Measurables"):Object(l["translate"])("SitesManager_Sites"))},mainDescription:function(){return Object(l["translate"])("SitesManager_YouCurrentlyHaveAccessToNWebsites","<strong>".concat(this.totalNumberOfSites,"</strong>"))},hasSuperUserAccess:function(){return l["Matomo"].hasSuperUserAccess},superUserAccessMessage:function(){return Object(l["translate"])("SitesManager_SuperUserAccessCan","<a href='#globalSettings'>","</a>")},hasPrev:function(){return this.currentPage>=1},hasNext:function(){return this.sites.length===this.pageSize},offsetStart:function(){return this.currentPage*this.pageSize+1},offsetEnd:function(){return this.offsetStart+this.sites.length-1}},methods:{addNewEntity:function(){this.availableTypes.length>1?this.showAddSiteDialog=!0:1===this.availableTypes.length&&this.addSite(this.availableTypes[0].id)},addSite:function(e){var t=e,n={isAllowed:!0,measurableType:t};l["Matomo"].postEvent("SitesManager.initAddSite",n),n&&!n.isAllowed||(t||(t="website"),this.sites.unshift({type:t}))},afterCancelEdit:function(e){var t=e.site,n=e.element;t.idsite?(this.isSiteBeingEdited=!1,n.scrollIntoView()):this.sites=this.sites.filter((function(e){return!!e.idsite}))},fetchLimitedSitesWithAdminAccess:function(){var e=this;this.fetchLimitedSitesAbortController&&this.fetchLimitedSitesAbortController.abort(),this.fetchLimitedSitesAbortController=new AbortController;var t=this.pageSize,n=this.currentPage*this.pageSize,a={method:"SitesManager.getSitesWithAdminAccess",fetchAliasUrls:1,limit:t+n,filter_offset:n,filter_limit:t};return this.searchTerm&&(a.pattern=this.searchTerm),l["AjaxHelper"].fetch(a).then((function(t){e.sites=t||[]})).finally((function(){e.fetchLimitedSitesAbortController=null}))},getTotalNumberOfSites:function(){var e=this;return l["AjaxHelper"].fetch({method:"SitesManager.getSitesIdWithAdminAccess",filter_limit:"-1"}).then((function(t){e.totalNumberOfSites=t.length}))},triggerAddSiteIfRequested:function(){var e=l["MatomoUrl"].urlParsed.value.showaddsite;"1"===e&&this.addNewEntity()},previousPage:function(){this.currentPage=Math.max(0,this.currentPage-1),this.fetchLimitedSitesWithAdminAccess()},nextPage:function(){this.currentPage=Math.max(0,this.currentPage+1),this.fetchLimitedSitesWithAdminAccess()},searchSites:function(e){this.searchTerm=e,this.currentPage=0,this.fetchLimitedSitesWithAdminAccess()},afterDelete:function(e){var t=Et({},l["MatomoUrl"].urlParsed.value);if(delete t.showaddsite,l["MatomoUrl"].urlParsed.value.idSite===e.idsite){var n=this.sites.find((function(t){return t.idsite!==e.idsite}));n&&(t=Et(Et({},t),{},{idSite:n.idsite}))}l["MatomoUrl"].updateUrl(t,l["MatomoUrl"].hashParsed.value)},afterSave:function(e,t,n){var a=["excluded_ips","excluded_parameters","excluded_user_agents","sitesearch_keyword_parameters","sitesearch_category_parameters"],r=Et({},e);Object.values(t).forEach((function(e){e.forEach((function(e){"urls"===e.name?r.alias_urls=e.value:-1!==a.indexOf(e.name)?r[e.name]=e.value.join(", "):r[e.name]=e.value}))})),this.sites[n]=r}}});Vt.render=C;var xt=Vt,Tt=(Object(l["createAngularJsAdapter"])({component:xt,scope:{},directiveName:"matomoSitesManagement"}),{class:"SitesManager"}),Pt=Object(i["createElementVNode"])("a",{name:"globalSettings",id:"globalSettings"},null,-1),wt={id:"excludedIpsGlobalHelp",class:"inline-help-node"},Mt=Object(i["createElementVNode"])("br",null,null,-1),Ct=Object(i["createElementVNode"])("br",null,null,-1),Dt=["innerHTML"],At={id:"excludedQueryParametersGlobalHelp",class:"inline-help-node"},_t=Object(i["createElementVNode"])("br",null,null,-1),kt=Object(i["createElementVNode"])("br",null,null,-1),Gt={id:"excludedUserAgentsGlobalHelp",class:"inline-help-node"},Ut=Object(i["createElementVNode"])("br",null,null,-1),Lt=Object(i["createElementVNode"])("br",null,null,-1),It={id:"timezoneHelp",class:"inline-help-node"},Bt={key:0},zt=Object(i["createElementVNode"])("br",null,null,-1),Ht=Object(i["createElementVNode"])("br",null,null,-1),Ft={id:"keepURLFragmentsHelp",class:"inline-help-node"},Rt=["innerHTML"],Wt={class:"alert alert-info"};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Kt(e,t,n,a,r,l){var o=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveComponent"])("ContentBlock");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Tt,[Object(i["withDirectives"])(Object(i["createVNode"])(s,{"content-title":e.translate("SitesManager_GlobalWebsitesSettings")},{default:Object(i["withCtx"])((function(){return[Pt,Object(i["createElementVNode"])("div",wt,[Object(i["createElementVNode"])("div",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("SitesManager_HelpExcludedIpAddresses","1.2.3.4/24","1.2.3.*","1.2.*.*"))+" ",1),Mt,Ct,Object(i["createElementVNode"])("span",{innerHTML:e.yourCurrentIpAddressIs},null,8,Dt)])]),Object(i["createElementVNode"])("div",At,[Object(i["createElementVNode"])("div",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("SitesManager_ListOfQueryParametersToExclude","/^sess.*|.*[dD]ate$/"))+" ",1),_t,kt,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("SitesManager_PiwikWillAutomaticallyExcludeCommonSessionParameters","phpsessid, sessionid, ...")),1)])]),Object(i["createElementVNode"])("div",Gt,[Object(i["createElementVNode"])("div",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp1"))+" ",1),Ut,Lt,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("SitesManager_GlobalListExcludedUserAgents_Desc"))+" "+Object(i["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp2"))+" "+Object(i["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp3","/bot|spider|crawl|scanner/i")),1)])]),Object(i["createElementVNode"])("div",It,[Object(i["createElementVNode"])("div",null,[e.timezoneSupportEnabled?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Bt,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("SitesManager_AdvancedTimezoneSupportNotFound"))+" ",1),zt])),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("SitesManager_UTCTimeIs",e.utcTimeDate))+" ",1),Ht,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("SitesManager_ChangingYourTimezoneWillOnlyAffectDataForward")),1)])]),Object(i["createElementVNode"])("div",Ft,[Object(i["createElementVNode"])("div",{innerHTML:e.keepUrlFragmentHelp},null,8,Rt),Object(i["createElementVNode"])("div",null,Object(i["toDisplayString"])(e.translate("SitesManager_KeepURLFragmentsHelp2")),1)]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(o,{uicontrol:"textarea",name:"excludedIpsGlobal","var-type":"array",modelValue:e.excludedIpsGlobal,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.excludedIpsGlobal=t}),title:e.translate("SitesManager_ListOfIpsToBeExcludedOnAllWebsites"),introduction:e.translate("SitesManager_GlobalListExcludedIps"),"inline-help":"#excludedIpsGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(o,{uicontrol:"textarea",name:"excludedQueryParametersGlobal","var-type":"array",modelValue:e.excludedQueryParametersGlobal,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.excludedQueryParametersGlobal=t}),title:e.translate("SitesManager_ListOfQueryParametersToBeExcludedOnAllWebsites"),introduction:e.translate("SitesManager_GlobalListExcludedQueryParameters"),"inline-help":"#excludedQueryParametersGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(o,{uicontrol:"textarea",name:"excludedUserAgentsGlobal","var-type":"array",modelValue:e.excludedUserAgentsGlobal,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.excludedUserAgentsGlobal=t}),title:e.translate("SitesManager_GlobalListExcludedUserAgents_Desc"),introduction:e.translate("SitesManager_GlobalListExcludedUserAgents"),"inline-help":"#excludedUserAgentsGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(o,{uicontrol:"checkbox",name:"keepURLFragmentsGlobal",modelValue:e.keepURLFragmentsGlobal,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.keepURLFragmentsGlobal=t}),title:e.translate("SitesManager_KeepURLFragmentsLong"),introduction:e.translate("SitesManager_KeepURLFragments"),"inline-help":"#keepURLFragmentsHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("SitesManager_TrackingSiteSearch")),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("SitesManager_SiteSearchUse")),1),Object(i["createElementVNode"])("div",Wt,Object(i["toDisplayString"])(e.translate("SitesManager_SearchParametersNote"))+" "+Object(i["toDisplayString"])(e.translate("SitesManager_SearchParametersNote2")),1),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(o,{uicontrol:"text",name:"searchKeywordParametersGlobal","var-type":"array",modelValue:e.searchKeywordParametersGlobal,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.searchKeywordParametersGlobal=t}),title:e.translate("SitesManager_SearchKeywordLabel"),"inline-help":e.translate("SitesManager_SearchKeywordParametersDesc"),disabled:e.isLoading},null,8,["modelValue","title","inline-help","disabled"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(o,{uicontrol:"text",name:"searchCategoryParametersGlobal","var-type":"array",modelValue:e.searchCategoryParametersGlobal,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.searchCategoryParametersGlobal=t}),title:e.translate("SitesManager_SearchCategoryLabel"),"inline-help":e.searchCategoryParamsInlineHelp,disabled:e.isLoading},null,8,["modelValue","title","inline-help","disabled"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(o,{uicontrol:"select",name:"defaultTimezone",options:e.timezones,title:e.translate("SitesManager_SelectDefaultTimezone"),introduction:e.translate("SitesManager_DefaultTimezoneForNewWebsites"),"inline-help":"#timezoneHelp",disabled:e.isLoading},null,8,["options","title","introduction","disabled"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(o,{uicontrol:"select",name:"defaultCurrency",modelValue:e.defaultCurrency,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.defaultCurrency=t}),options:e.currencies,title:e.translate("SitesManager_SelectDefaultCurrency"),introduction:e.translate("SitesManager_DefaultCurrencyForNewWebsites"),"inline-help":e.translate("SitesManager_CurrencySymbolWillBeUsedForGoals"),disabled:e.isLoading},null,8,["modelValue","options","title","introduction","inline-help","disabled"])]),Object(i["createVNode"])(c,{saving:e.isSaving,onConfirm:t[7]||(t[7]=function(t){return e.saveGlobalSettings()})},null,8,["saving"])]})),_:1},8,["content-title"]),[[i["vShow"],e.hasSuperUserAccess]])])}var qt=Object(i["defineComponent"])({props:{dummy:String},components:{ContentBlock:l["ContentBlock"],Field:Ge["Field"],SaveButton:Ge["SaveButton"]},data:function(){var e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),n=yt.globalSettings.value;return{currentIpAddress:null,utcTime:t,keepURLFragmentsGlobal:n.keepURLFragmentsGlobal,defaultTimezone:n.defaultTimezone,defaultCurrency:n.defaultCurrency,excludedIpsGlobal:n.excludedIpsGlobal.split(","),excludedQueryParametersGlobal:n.excludedQueryParametersGlobal.split(","),excludedUserAgentsGlobal:n.excludedUserAgentsGlobal.split(","),searchKeywordParametersGlobal:n.searchKeywordParametersGlobal.split(","),searchCategoryParametersGlobal:n.searchCategoryParametersGlobal.split(",")}},created:function(){var e=this;Object(i["watch"])((function(){return yt.globalSettings.value}),(function(t){e.keepURLFragmentsGlobal=t.keepURLFragmentsGlobal,e.defaultTimezone=t.defaultTimezone,e.defaultCurrency=t.defaultCurrency,e.excludedIpsGlobal=t.excludedIpsGlobal.split(","),e.excludedQueryParametersGlobal=t.excludedQueryParametersGlobal.split(","),e.excludedUserAgentsGlobal=t.excludedUserAgentsGlobal.split(","),e.searchKeywordParametersGlobal=t.searchKeywordParametersGlobal.split(","),e.searchCategoryParametersGlobal=t.searchCategoryParametersGlobal.split(",")})),l["AjaxHelper"].fetch({method:"API.getIpFromHeader"}).then((function(t){e.currentIpAddress=t.value}))},methods:{saveGlobalSettings:function(){yt.saveGlobalSettings({keepURLFragmentsGlobal:this.keepURLFragmentsGlobal,defaultCurrency:this.defaultCurrency,defaultTimezone:this.defaultCurrency,excludedIpsGlobal:this.excludedIpsGlobal.join(","),excludedQueryParametersGlobal:this.excludedQueryParametersGlobal.join(","),excludedUserAgentsGlobal:this.excludedUserAgentsGlobal.join(","),searchKeywordParametersGlobal:this.searchKeywordParametersGlobal.join(","),searchCategoryParametersGlobal:this.searchCategoryParametersGlobal.join(",")})}},computed:{isLoading:function(){return yt.isLoading.value||Qe.isLoading.value||et.isLoading.value},isSaving:function(){return yt.isLoading.value},timezones:function(){return Qe.timezones.value},currencies:function(){return et.currencies.value},hasSuperUserAccess:function(){return l["Matomo"].hasSuperUserAccess},yourCurrentIpAddressIs:function(){return Object(l["translate"])("SitesManager_YourCurrentIpAddressIs","<i>".concat(this.currentIpAddress,"</i>"))},timezoneSupportEnabled:function(){return Qe.timezoneSupportEnabled.value},utcTimeDate:function(){var e=this.utcTime,t=function(e){return e.toString().padStart(2,"0")},n=t(e.getHours()),a=t(e.getMinutes()),r=t(e.getSeconds());return"".concat(Object(l["format"])(this.utcTime)," ").concat(n,":").concat(a,":").concat(r)},keepUrlFragmentHelp:function(){return Object(l["translate"])("SitesManager_KeepURLFragmentsHelp","<em>#</em>","<em>example.org/index.html#first_section</em>","<em>example.org/index.html</em>")},searchCategoryParamsInlineHelp:function(){var e=[Object(l["translate"])("Goals_Optional"),Object(l["translate"])("SitesManager_SearchCategoryDesc"),Object(l["translate"])("SitesManager_SearchCategoryParametersDesc")];return e.join(" ")}}});qt.render=Kt;var Qt=qt;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */Object(l["createAngularJsAdapter"])({component:Qt,scope:{},directiveName:"matomoGlobalSettings"})}})}));
//# sourceMappingURL=SitesManager.umd.min.js.map