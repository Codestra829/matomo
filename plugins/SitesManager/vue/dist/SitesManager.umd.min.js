(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["SitesManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["SitesManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/SitesManager/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"SiteTypesStore",(function(){return h})),n.d(t,"SiteFields",(function(){return Ue})),n.d(t,"CurrencyStore",(function(){return Ne})),n.d(t,"TimezoneStore",(function(){return ge})),"undefined"!==typeof window){var r=window.document.currentScript,i=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var a=n("8bbf"),o=n("19dc");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var p=window,m=p.$,f=function(){function e(){var t=this;s(this,e),b(this,"state",Object(a["reactive"])({typesById:{}})),b(this,"typesById",Object(a["computed"])((function(){return Object(a["readonly"])(t.state).typesById}))),b(this,"response",void 0),this.fetchAvailableTypes()}return d(e,[{key:"fetchAvailableTypes",value:function(){var e=this;return this.response?Promise.resolve(this.response):(this.response=o["AjaxHelper"].fetch({method:"API.getAvailableMeasurableTypes",filter_limit:"-1"}).then((function(t){return t.forEach((function(t){e.state.typesById[t.id]=t})),e.typesById.value})),this.response)}},{key:"getEditSiteIdParameter",value:function(){var e=o["MatomoUrl"].hashParsed.value.editsiteid;if(e&&m.isNumeric(e))return e}},{key:"removeEditSiteIdParameterFromHash",value:function(){var e=l({},o["MatomoUrl"].hashParsed.value);delete e.editsiteid,o["MatomoUrl"].updateHash(e)}}]),e}(),h=Object(o["lazyInitSingleton"])(f);
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function O(){return{get typesById(){return h.typesById.value},fetchTypeById:function(e){return h.fetchAvailableTypes().then((function(t){return t[e]}))},fetchAvailableTypes:function(){return h.fetchAvailableTypes()},hasMultipleTypes:function(){return h.fetchAvailableTypes().then((function(e){return e&&Object.keys(e).length>1}))},removeEditSiteIdParameterFromHash:h.removeEditSiteIdParameterFromHash.bind(h),getEditSiteIdParameter:h.getEditSiteIdParameter.bind(h)}}window.angular.module("piwikApp.service").factory("sitesManagerTypeModel",O);var j=["idsite","type"],g={class:"card-content"},y={key:0,class:"row"},S={class:"col m3"},v={class:"title"},E={class:"title"},V=["target","title","href"],N={class:"col m4"},w={class:"title"},T={class:"title"},P={class:"title"},D={class:"title"},k={class:"col m4"},M={class:"title"},_=Object(a["createTextVNode"])(": "),x=["href"],C={key:0},A={class:"title"},B={key:1},I={class:"title"},U={key:2},z={class:"title"},H={class:"col m1 text-right"},F=["title"],G=Object(a["createElementVNode"])("span",{class:"icon-edit"},null,-1),L=[G],$=["title"],q=Object(a["createElementVNode"])("span",{class:"icon-delete"},null,-1),J=[q],Y={key:1},R={class:"form-group row"},W={class:"col s12 m6 input-field"},K=["placeholder"],Q=Object(a["createElementVNode"])("div",{class:"col s12 m6"},null,-1),X={id:"timezoneHelpText",class:"inline-help-node"},Z={key:0},ee=Object(a["createElementVNode"])("br",null,null,-1),te=Object(a["createElementVNode"])("br",null,null,-1),ne={class:"editingSiteFooter"},re=["value"],ie=["value"],ae=["value"];function oe(e,t,n,r,i,o){var c=this,l=Object(a["resolveComponent"])("ActivityIndicator"),s=Object(a["resolveComponent"])("PluginSetting"),u=Object(a["resolveComponent"])("Field"),d=Object(a["resolveComponent"])("MatomoDialog");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])(["site card hoverable",{editingSite:!!e.editMode}]),idsite:e.theSite.idsite,type:e.theSite.type},[Object(a["createElementVNode"])("div",g,[e.editMode?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",y,[Object(a["createElementVNode"])("div",S,[Object(a["createElementVNode"])("h4",null,Object(a["toDisplayString"])(e.theSite.name),1),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("span",v,Object(a["toDisplayString"])(e.translate("General_Id"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.theSite.idsite),1)]),Object(a["withDirectives"])(Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("span",E,Object(a["toDisplayString"])(e.translate("SitesManager_Type"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.currentType.name),1)],512),[[a["vShow"],e.availableTypes.length>1]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("a",{target:e.isInternalSetupUrl?"_self":"_blank",title:e.translate("SitesManager_ShowTrackingTag"),href:e.setupUrl},Object(a["toDisplayString"])(e.translate("SitesManager_ShowTrackingTag")),9,V)],512),[[a["vShow"],e.theSite.idsite&&e.howToSetupUrl]])])]),Object(a["createElementVNode"])("div",N,[Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("span",w,Object(a["toDisplayString"])(e.translate("SitesManager_Timezone"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.theSite.timezone_name),1)]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("span",T,Object(a["toDisplayString"])(e.translate("SitesManager_Currency"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.theSite.currency_name),1)]),Object(a["withDirectives"])(Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("span",P,Object(a["toDisplayString"])(e.translate("Goals_Ecommerce"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("General_Yes")),1)],512),[[a["vShow"],1===e.theSite.ecommerce]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("span",D,Object(a["toDisplayString"])(e.translate("Actions_SubmenuSitesearch"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("General_Yes")),1)],512),[[a["vShow"],1==e.theSite.sitesearch]])])]),Object(a["createElementVNode"])("div",k,[Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("span",M,Object(a["toDisplayString"])(e.translate("SitesManager_Urls")),1),_,(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.theSite.alias_urls,(function(t,n){return Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:t},[Object(a["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:t},Object(a["toDisplayString"])(t)+Object(a["toDisplayString"])(n===e.theSite.alias_urls.length-1?"":", "),9,x)])})),128))]),e.theSite.excluded_ips.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",C,[Object(a["createElementVNode"])("span",A,Object(a["toDisplayString"])(e.translate("SitesManager_ExcludedIps"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.theSite.excluded_ips),1)])):Object(a["createCommentVNode"])("",!0),e.theSite.excluded_parameters.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",B,[Object(a["createElementVNode"])("span",I,Object(a["toDisplayString"])(e.translate("SitesManager_ExcludedParameters"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.theSite.excluded_parameters),1)])):Object(a["createCommentVNode"])("",!0),e.theSite.excluded_user_agents.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",U,[Object(a["createElementVNode"])("span",z,Object(a["toDisplayString"])(e.translate("SitesManager_ExcludedUserAgents"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.theSite.excluded_user_agents),1)])):Object(a["createCommentVNode"])("",!0)])]),Object(a["createElementVNode"])("div",H,[Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("button",{class:"table-action",onClick:t[0]||(t[0]=function(t){return e.editSite()}),title:e.translate("General_Edit")},L,8,F)]),Object(a["createElementVNode"])("li",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("button",{class:"table-action",onClick:t[1]||(t[1]=function(e){return c.showRemoveDialog=!0}),title:e.translate("General_Delete")},J,8,$),[[a["vShow"],e.theSite.idsite]])])])])])),e.editMode?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Y,[Object(a["createElementVNode"])("div",R,[Object(a["createElementVNode"])("div",W,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.theSite.name=t}),maxlength:"90",placeholder:e.translate("General_Name")},null,8,K),[[a["vModelText"],e.theSite.name]]),Object(a["createElementVNode"])("label",null,Object(a["toDisplayString"])(e.translate("General_Name")),1)]),Q]),Object(a["createVNode"])(l,{loading:e.isLoading},null,8,["loading"]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.measurableSettings,(function(t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:t.plugin},[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(t.settings,(function(n){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:"".concat(t.pluginName,".").concat(n.name)},[Object(a["createVNode"])(s,{modelValue:e.settingValues["".concat(t.pluginName,".").concat(n.name)],"onUpdate:modelValue":function(r){return e.settingValues["".concat(t.pluginName,".").concat(n.name)]=r},"plugin-name":t.pluginName,setting:n,"setting-values":e.settingValues},null,8,["modelValue","onUpdate:modelValue","plugin-name","setting","setting-values"])])})),128))])})),128)),Object(a["createVNode"])(u,{uicontrol:"select",name:"currency",modelValue:e.theSite.currency,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.theSite.currency=t}),title:e.translate("SitesManager_Currency"),"inline-help":e.translate("SitesManager_CurrencySymbolWillBeUsedForGoals"),options:e.currencies},null,8,["modelValue","title","inline-help","options"]),Object(a["createVNode"])(u,{uicontrol:"select",name:"timezone",modelValue:e.theSite.timezone,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.theSite.timezone=t}),title:e.translate("SitesManager_Timezone"),"inline-help":"#timezoneHelpText",options:e.timezones},null,8,["modelValue","title","options"]),Object(a["createElementVNode"])("div",X,[Object(a["createElementVNode"])("div",null,[e.timezoneSupportEnabled?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Z,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("SitesManager_AdvancedTimezoneSupportNotFound"))+" ",1),ee])),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.utcTimeIs)+" ",1),te,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("SitesManager_ChangingYourTimezoneWillOnlyAffectDataForward")),1)])]),Object(a["createElementVNode"])("div",ne,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"submit",class:"btn",value:e.translate("General_Save"),onClick:t[5]||(t[5]=function(t){return e.saveSite()})},null,8,re),[[a["vShow"],!e.isLoading]]),Object(a["createElementVNode"])("button",{class:"btn btn-link",onClick:t[6]||(t[6]=function(t){return e.cancelEditSite(e.site)})},Object(a["toDisplayString"])(e.translate("General_Cancel","","")),1)])])):Object(a["createCommentVNode"])("",!0)]),Object(a["createVNode"])(d,{class:"ui-confirm",modelValue:e.showRemoveDialog,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.showRemoveDialog=t}),onYes:t[8]||(t[8]=function(t){return e.deleteSite()})},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.removeDialogTitle),1),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("SitesManager_DeleteSiteExplanation")),1),Object(a["createElementVNode"])("input",{type:"button",value:e.translate("General_Yes"),role:"yes"},null,8,ie),Object(a["createElementVNode"])("input",{type:"button",value:e.translate("General_No"),role:"no"},null,8,ae)]})),_:1},8,["modelValue"])],10,j)}var ce=n("a5a2");function le(e,t){return pe(e)||be(e,t)||ue(e,t)||se()}function se(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ue(e,t){if(e){if("string"===typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(e,t):void 0}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function be(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(r=n.next()).done);o=!0)if(a.push(r.value),t&&a.length===t)break}catch(l){c=!0,i=l}finally{try{o||null==n["return"]||n["return"]()}finally{if(c)throw i}}return a}}function pe(e){if(Array.isArray(e))return e}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t,n){return t&&fe(e.prototype,t),n&&fe(e,n),e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var je=function(){function e(){var t=this;me(this,e),Oe(this,"privateState",Object(a["reactive"])({timezones:[]})),Oe(this,"timezones",Object(a["computed"])((function(){return Object(a["readonly"])(t.privateState).timezones}))),this.fetchTimezones()}return he(e,[{key:"fetchTimezones",value:function(){var e=this;o["AjaxHelper"].fetch({method:"SitesManager.getTimezonesList"}).then((function(t){var n=[];Object.entries(t).forEach((function(e){var t=le(e,2),r=t[0],i=t[1];Object.entries(i).forEach((function(e){var t=le(e,2),i=t[0],a=t[1];n.push({group:r,label:i,code:a})}))})),e.privateState.timezones=n}))}}]),e}(),ge=Object(o["lazyInitSingleton"])(je);function ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e,t,n){return t&&Se(e.prototype,t),n&&Se(e,n),e}function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Ve=function(){function e(){var t=this;ye(this,e),Ee(this,"privateState",Object(a["reactive"])({currencies:{}})),Ee(this,"currencies",Object(a["computed"])((function(){return Object(a["readonly"])(t.privateState).currencies}))),this.fetchCurrencies()}return ve(e,[{key:"fetchCurrencies",value:function(){var e=this;o["AjaxHelper"].fetch({method:"SitesManager.getCurrencyList"}).then((function(t){e.privateState.currencies=t}))}}]),e}(),Ne=Object(o["lazyInitSingleton"])(Ve);function we(e,t){return Me(e)||ke(e,t)||Pe(e,t)||Te()}function Te(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Pe(e,t){if(e){if("string"===typeof e)return De(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?De(e,t):void 0}}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ke(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(r=n.next()).done);o=!0)if(a.push(r.value),t&&a.length===t)break}catch(l){c=!0,i=l}finally{try{o||null==n["return"]||n["return"]()}finally{if(c)throw i}}return a}}function Me(e){if(Array.isArray(e))return e}function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){Ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ae=Object(a["computed"])((function(){return ge.timezones.value.map((function(e){var t=e.group,n=e.label,r=e.code;return{group:t,key:n,value:r}}))}));function Be(e){return"undefined"===typeof e.idsite}var Ie=Object(a["defineComponent"])({props:{site:{type:Object,required:!0},timezoneSupportEnabled:{type:Boolean},utcTime:{type:Date,required:!0},globalSettings:{type:Object,required:!0}},data:function(){return{isLoading:!1,editMode:!1,theSite:xe({},this.site),measurableSettings:[],settingValues:{},showRemoveDialog:!1}},components:{MatomoDialog:o["MatomoDialog"],Field:ce["Field"],PluginSetting:ce["PluginSetting"],ActivityIndicator:o["ActivityIndicator"]},emits:["delete","cancelEditSite","save"],created:function(){this.onSiteChanged()},watch:{site:function(){this.onSiteChanged()},measurableSettings:function(e){if(e.length){var t={};e.forEach((function(e){e.settings.forEach((function(n){t["".concat(e.pluginName,".").concat(n.name)]=n.value}))})),this.settingValues=t}}},methods:{onSiteChanged:function(){var e=this,t=this.site;this.theSite=xe({},t);var n=Be(t);if(n){var r=this.globalSettings;this.theSite.timezone=r.defaultTimezone,this.theSite.currency=r.defaultCurrency}var i=h.getEditSiteIdParameter();(n||i&&"".concat(t.idsite)===i)&&h.fetchAvailableTypes().then((function(){e.editSite()}))},editSite:function(){var e=this;if(this.editMode=!0,this.measurableSettings=[],Be(this.theSite)){if(!this.currentType)return;this.measurableSettings=this.currentType.settings||[]}else this.isLoading=!0,o["AjaxHelper"].fetch({method:"SitesManager.getSiteSettings",idSite:this.theSite.idsite}).then((function(t){e.measurableSettings=t})).finally((function(){e.isLoading=!1}))},saveSite:function(){var e=this,t={siteName:this.theSite.name,timezone:this.theSite.timezone,currency:this.theSite.currency,type:this.theSite.type,settingValues:{}},n=Be(this.theSite),r="SitesManager.addSite";n||(r="SitesManager.updateSite",t.idSite=this.theSite.idsite),Object.entries(this.settingValues).forEach((function(e){var n=we(e,2),r=n[0],i=n[1],a=r.split("."),o=we(a,2),c=o[0],l=o[1],s=t.settingValues;s[c]||(s[c]=[]);var u=i;!1===i?u="0":!0===i?u="1":Array.isArray(i)&&(u=i.filter((function(e){return!!e}))),s[c].push({name:l,value:u})})),o["AjaxHelper"].post({method:r},t).then((function(r){e.editMode=!1,!e.theSite.idsite&&r&&r.value&&(e.theSite.idsite=r.value);var i=o["NotificationsStore"].show({message:n?Object(o["translate"])("SitesManager_WebsiteCreated"):Object(o["translate"])("SitesManager_WebsiteUpdated"),context:"success",id:"websitecreated",type:"transient"});o["NotificationsStore"].scrollToNotification(i),h.removeEditSiteIdParameterFromHash(),e.$emit("save",{site:e.theSite,settingValues:t.settingValues})}))},cancelEditSite:function(e){this.editMode=!1,h.removeEditSiteIdParameterFromHash(),this.$emit("cancelEditSite",e)},deleteSite:function(){var e=this;o["AjaxHelper"].fetch({idSite:this.theSite.idsite,module:"API",format:"json",method:"SitesManager.deleteSite"}).then((function(){e.$emit("delete",e.theSite)}))}},computed:{availableTypes:function(){return h.typesById.value},setupUrl:function(){var e=this.theSite,t="";return this.isInternalSetupUrl&&(t=o["MatomoUrl"].stringify({idSite:e.idsite,period:o["MatomoUrl"].parsed.value.period,date:o["MatomoUrl"].parsed.value.date,updated:"false"})),"".concat(this.howToSetupUrl).concat(t)},utcTimeIs:function(){var e=this.utcTime,t=function(e){return e.toString().padStart(2,"0")},n=t(e.getHours()),r=t(e.getMinutes()),i=t(e.getSeconds()),a="".concat(Object(o["format"])(this.utcTime)," ").concat(n,":").concat(r,":").concat(i);return Object(o["translate"])("SitesManager_UTCTimeIs",a)},timezones:function(){return Ae.value},currencies:function(){return Ne.currencies.value},currentType:function(){var e=this.site,t=h.typesById.value[e.type];return t||{name:e.type}},howToSetupUrl:function(){var e=this.currentType;if(e)return e.howToSetupUrl},isInternalSetupUrl:function(){var e=this.howToSetupUrl;return!!e&&"?"==="".concat(e).substring(0,1)},removeDialogTitle:function(){return Object(o["translate"])("SitesManager_DeleteConfirm",'"'.concat(this.theSite.name,'" (idSite = ').concat(this.theSite.idsite,")"))}}});Ie.render=oe;var Ue=Ie;function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */Object(o["createAngularJsAdapter"])({component:Ue,scope:{site:{angularJsBind:"<"},timezoneSupportEnabled:{angularJsBind:"<"},utcTime:{angularJsBind:"<"},globalSettings:{angularJsBind:"<"}},directiveName:"matomoSiteFields",$inject:["$timeout"],events:{delete:function(e,t,n){var r=n.redirectParams;if(o["MatomoUrl"].urlParsed.value.idSite===e.idsite){var i=n.adminSites.sites,a=i.find((function(t){return t.idsite!==e.idsite}));a&&(r=He(He({},r),{},{idSite:a.idsite}))}o["MatomoUrl"].updateUrl(He(He({},o["MatomoUrl"].urlParsed.value),{},{redirectParams:r}),o["MatomoUrl"].hashParsed.value)},save:function(e,t,n,r,i,a,o){var c=e.site,l=e.settingValues,s=["excluded_ips","excluded_parameters","excluded_user_agents"],u=He({},c);Object.values(l).forEach((function(e){e.forEach((function(e){"urls"===e.name?u.alias_urls=e.value:-1!==s.indexOf(e.name)?u[e.name]=e.value.join(", "):u[e.name]=e.value}))})),window.$.extend(n.site,u),o(),t.site=u}}});
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# sourceMappingURL=SitesManager.umd.min.js.map